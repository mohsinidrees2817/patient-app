(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2053:(e,t,a)=>{Promise.resolve().then(a.bind(a,7850))},2383:()=>{},3686:()=>{},7850:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(5155),r=a(2115),l=a(8455),n=a(9911),o=a(3925);function d(){let{selectedFile:e,tableData:t,setTableData:a,startStreaming:d,updateSummaryInGlobalState:i}=(0,l.A)(),[c,m]=(0,r.useState)(null),[p,x]=(0,r.useState)("");(0,r.useEffect)(()=>{e&&d(e)},[e]);let u=e=>{m(e),x(t[e].summary)};return(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-lg font-semibold text-black",children:"FILE PREVIEW"}),(0,s.jsx)("p",{className:"text-sm py-1 text-[#a6a6a6]",children:"Your uploaded file will be displayed here."})]}),e&&(0,s.jsx)("button",{onClick:()=>{if(0===t.length)return;let e=o.Wp.json_to_sheet(t),a=o.Wp.book_new();o.Wp.book_append_sheet(a,e,"Sheet1");let s=new Blob([o.M9(a,{bookType:"xlsx",type:"array"})],{type:"application/octet-stream"}),r=URL.createObjectURL(s),l=document.createElement("a");l.href=r,l.download="downloaded_data.xlsx",document.body.appendChild(l),l.click(),document.body.removeChild(l)},className:"py-3 px-3 rounded-md text-white text-xs font-bold bg-gradient-to-r from-[#046dfd] via-blue-400 to-[#3cace6] cursor-pointer",disabled:0===t.length,children:"Download CSV"})]}),t.length>0?(0,s.jsxs)("div",{className:"mt-4 overflow-x-auto bg-white   rounded-lg border border-[#e4e5e7] min-h-[60vh] h-full",children:[e&&(0,s.jsx)("p",{className:"text-xl text-[#1e7ce7] rounded-t-2xl text-start py-4 px-4",children:null==e?void 0:e.name}),(0,s.jsxs)("table",{className:"min-w-full border border-[#e4e5e7] text-white ",children:[(0,s.jsx)("thead",{className:"rounded-t-2xl",children:(0,s.jsxs)("tr",{className:"bg-[#f3f2f7] text-sm text-start ",children:[Object.keys(t[0]).slice(0,2).map((e,t)=>(0,s.jsx)("th",{className:"py-4 px-4 ".concat(0===t?"w-[200px] font-bold":"w-[300px] overflow-hidden text-ellipsis whitespace-nowrap"," text-black border  border-[#e4e5e7] text-start"),children:e},t)),(0,s.jsx)("th",{className:"py-4 px-4 border border-[#e4e5e7] text-black text-start w-[150px]",children:"Status"}),(0,s.jsx)("th",{className:"py-4 px-4 border border-[#e4e5e7] text-black text-start",children:"Summary"})]})}),(0,s.jsx)("tbody",{className:"text-sm",children:t.map((e,t)=>(0,s.jsxs)("tr",{className:"border-b border-[#e4e5e7] text-black relative  ".concat(c===t?"bg-[#f3f6ff]":""),children:[Object.values(e).slice(0,2).map((e,t)=>(0,s.jsx)("td",{className:"py-3 px-4 border border-[#e4e5e7] text-black",children:e},t)),(0,s.jsxs)("td",{className:"py-4 px-4 text-start text-black min-w-[100px] flex items-center gap-2",children:[(0,s.jsx)("span",{className:"py-1 px-2 text-xs rounded-full ".concat("Pending"===e.status?"bg-red-500/40 text-red-600 font-bold":"In Progress"===e.status?"bg-blue-500/40 text-blue-600 font-bold":"bg-green-500/40 text-green-600 font-bold"),children:e.status}),"In Progress"===e.status&&(0,s.jsxs)("svg",{viewBox:"0 0 200 200",width:20,height:20,children:[(0,s.jsxs)("linearGradient",{id:"a11",children:[(0,s.jsx)("stop",{offset:"0",stopColor:"#2984FF",stopOpacity:"0"}),(0,s.jsx)("stop",{offset:"1",stopColor:"#2984FF"})]}),(0,s.jsx)("circle",{fill:"none",stroke:"url(#a11)",strokeWidth:"35",strokeLinecap:"round",strokeDasharray:"0 44 0 44 0 44 0 44 0 360",cx:"100",cy:"100",r:"70",transformOrigin:"center",children:(0,s.jsx)("animateTransform",{type:"rotate",attributeName:"transform",calcMode:"discrete",dur:"1",values:"360;324;288;252;216;180;144;108;72;36",repeatCount:"indefinite"})})]})]}),(0,s.jsxs)("td",{className:"py-2 pl-4 pr-12 border border-[#e4e5e7] text-black",children:[e.summary,e.summary&&(0,s.jsx)(n.uO9,{className:"absolute right-4 top-5 cursor-pointer text-lg transition-colors ".concat(c===t?"text-blue-500":"text-black/60"),onClick:()=>u(t)})]})]},t))})]}),null!==c&&(0,s.jsx)("div",{className:"mx-6 my-8",children:(0,s.jsxs)("div",{className:"    relative  flex w-full px-4 py-6 border border-[#eef0f3] rounded-md bg-white shadow-2xl shadow-blue-50",children:[(0,s.jsx)("div",{className:"absolute right-2 top-2 cursor-pointer transition-colors bg-red-400/30 px-2 py-1 text-xs rounded-full text-red-500",onClick:()=>{m(null),x("")},children:"X"}),(0,s.jsx)("div",{className:"mx-3",children:(0,s.jsx)("div",{className:"w-16 h-16 bg-[#f3f2f7] rounded-full flex justify-center items-center",children:(0,s.jsx)(n.uO9,{className:" cursor-pointer text-xl transition-colors text-blue-500\n                             "})})}),(0,s.jsxs)("div",{className:"flex flex-col gap-1 w-full",children:[(0,s.jsx)("p",{className:"font-[600] ",children:"Edit Patient Summary"}),(0,s.jsx)("p",{className:"text-sm pt-1  text-[#a6a6a6]",children:"Modify the Al-generated summary before saving."}),(0,s.jsx)("input",{type:"text",value:p,onChange:e=>x(e.target.value),className:" p-2 w-full mt-3 text-black rounded-md focus:outline-none border-1 border-[#d2d4d9]",placeholder:"Edit summary..."}),(0,s.jsxs)("div",{className:"flex justify-start items-center gap-3",children:[(0,s.jsx)("button",{onClick:()=>{x(t[c].summary)},className:"mt-2 py-3 px-4 text-blue-400 border-2 border-blue-400 rounded-md min-w-[150px] font-bold text-sm hover:bg-gradient-to-r from-[#046dfd] via-blue-400 to-[#3cace6] cursor-pointer hover:text-white hover:border-white",children:"Reset"}),(0,s.jsx)("button",{onClick:()=>{null!==c&&(a(e=>e.map((e,t)=>t===c?{...e,summary:p}:e)),i(e,c,p),m(null),x(""))},className:"mt-2 py-3 px-4 bg-gradient-to-r from-[#046dfd] via-blue-400 to-[#3cace6] text-white rounded-md font-bold text-sm cursor-pointer hover:via-blue-600",children:"Save Changes"})]})]})]})})]}):(0,s.jsx)("p",{className:"text-white mt-4",children:"No data available."})]})}},8455:(e,t,a)=>{"use strict";a.d(t,{A:()=>c,MainProvider:()=>i});var s=a(5155),r=a(2115),l=a(408),n=a.n(l),o=a(3925);let d=(0,r.createContext)(),i=e=>{let{children:t}=e,[a,l]=(0,r.useState)([]),[i,c]=(0,r.useState)(null),[m,p]=(0,r.useState)([]),[x,u]=(0,r.useState)(!1),b=e=>new Promise(t=>{let a=new FileReader;a.onload=a=>{let{target:s}=a,r=[];if("text/csv"===e.type)n().parse(s.result,{header:!0,skipEmptyLines:!0,complete:e=>{t(e.data.map(e=>({...e,status:"Pending",summary:""})))}});else if("application/vnd.ms-excel"===e.type||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type){let e=o.LF(s.result,{type:"binary"}),a=e.SheetNames[0],r=e.Sheets[a],l=o.Wp.sheet_to_json(r,{header:1}),n=l[0];t(l.slice(1).map(e=>{let t={};return n.forEach((a,s)=>{t[a]=e[s]}),{...t,status:"Pending",summary:""}}))}else console.error("Unsupported file type:",e.type),t([])},"text/csv"===e.type?a.readAsText(e):a.readAsBinaryString(e)}),h=async e=>{let t=e.filter(e=>!a.some(t=>t.file.name===e.name&&t.file.size===e.size)||(console.warn("Skipping duplicate file: ".concat(e.name)),!1));if(0===t.length){console.warn("No new files to upload (all files are duplicates).");return}let s=await Promise.all(t.map(async e=>{let t=await b(e);return{file:e,status:"Pending",summary:"",tableData:t}}));l(e=>[...e,...s]),c(t[0]),p(s[0].tableData)},f=async e=>{let t=a.find(t=>t.file.name===e.name);if(t&&"Pending"===t.status){u(!0),l(t=>t.map(t=>t.file.name===e.name?{...t,status:"In Progress"}:t));for(let a=0;a<t.tableData.length;a++){let s=t.tableData[a];g(a,"In Progress");let r=await y(s,a,e);r&&(g(a,"Done"),j(a,r),l(t=>t.map(t=>t.file.name===e.name?{...t,tableData:t.tableData.map((e,t)=>t===a?{...e,status:"Done",summary:r}:e)}:t)))}l(t=>t.map(t=>t.file.name===e.name?{...t,status:"Done"}:t)),u(!1)}},y=async(e,t,a)=>{try{let a=await fetch("".concat("/jupyterlab/default/proxy/8000","/generate-summary"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));let s=a.body.getReader(),r=new TextDecoder,l="";for(;;){let{done:e,value:a}=await s.read();if(e)break;l+=r.decode(a,{stream:!0}),j(t,l)}return l}catch(e){return console.error("Error streaming summary:",e),g(t,"Error!"),j(t,""),l(e=>e.map(e=>e.file.name===a.name?{...e,tableData:e.tableData.map((e,a)=>a===t?{...e,status:"Error!",summary:""}:e)}:e)),""}},g=(e,t)=>{p(a=>a.map((a,s)=>s===e?{...a,status:t}:a)),l(a=>a.map(a=>a.file.name===i.name?{...a,tableData:a.tableData.map((a,s)=>s===e?{...a,status:t}:a)}:a))},j=(e,t)=>{p(a=>a.map((a,s)=>s===e?{...a,summary:t}:a)),l(a=>a.map(a=>a.file.name===i.name?{...a,tableData:a.tableData.map((a,s)=>s===e?{...a,summary:t}:a)}:a))};return(0,s.jsx)(d.Provider,{value:{data:a,setData:l,selectedFile:i,setSelectedFile:c,tableData:m,setTableData:p,handleFileUpload:h,startStreaming:f,updateRowSummary:j,updateRowStatus:g,updateSummaryInGlobalState:(e,t,a)=>{l(s=>s.map(s=>s.file.name===e.name?{...s,tableData:s.tableData.map((e,s)=>s===t?{...e,summary:a}:e)}:s))},proccesingState:x,setProccesingState:u},children:t})},c=()=>(0,r.useContext)(d)}},e=>{var t=t=>e(e.s=t);e.O(0,[711,524,217,441,684,358],()=>t(2053)),_N_E=e.O()}]);