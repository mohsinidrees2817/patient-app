exports.id=64,exports.ids=[64],exports.modules={480:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u,metadata:()=>p});var a=s(7413),r=s(6922),n=s.n(r),i=s(1980),l=s.n(i);s(1135),s(1120);var o=s(7166),c=s(5811);let d=({children:e})=>(0,a.jsxs)("div",{className:"flex relative bg-[#f2f3f4]",children:[(0,a.jsx)(o.default,{}),(0,a.jsxs)("div",{className:"flex-1   ",children:[(0,a.jsx)("div",{className:"static w-full",children:(0,a.jsx)(c.default,{})}),(0,a.jsx)("div",{className:"mt-4 py-6 mx-4 px-4 bg-white rounded-lg",children:e})]})]});var m=s(6173);let p={title:"Patient App",description:"patients app"};function u({children:e}){return(0,a.jsx)("html",{lang:"en",children:(0,a.jsx)("body",{className:`${n().variable} ${l().variable} antialiased  text-[#a5adbb]`,children:(0,a.jsx)(m.MainProvider,{children:(0,a.jsx)(d,{children:e})})})})}},1135:()=>{},1260:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,6444,23)),Promise.resolve().then(s.t.bind(s,6042,23)),Promise.resolve().then(s.t.bind(s,8170,23)),Promise.resolve().then(s.t.bind(s,9477,23)),Promise.resolve().then(s.t.bind(s,9345,23)),Promise.resolve().then(s.t.bind(s,2089,23)),Promise.resolve().then(s.t.bind(s,6577,23)),Promise.resolve().then(s.t.bind(s,1307,23))},4136:(e,t,s)=>{Promise.resolve().then(s.bind(s,5811)),Promise.resolve().then(s.bind(s,7166)),Promise.resolve().then(s.bind(s,6173))},5277:(e,t,s)=>{"use strict";s.d(t,{default:()=>o});var a=s(687);s(3210);var r=s(5814),n=s.n(r),i=s(6189);let l=[{id:1,name:"Dashboard",path:"/"},{id:2,name:"History",path:"/history/"}],o=()=>{let e=(0,i.usePathname)();return(0,a.jsx)("div",{className:"shadow-sm shadow-[#f2f3f4]",children:(0,a.jsxs)("div",{className:"flex justify-between items-center   w-full bg-white py-3 px-8",children:[(0,a.jsx)("div",{className:"flex items-center space-x-2 w-full ",children:l.map(t=>(0,a.jsx)(n(),{href:t.path,className:"",children:(0,a.jsx)("span",{className:`px-2
                  ${e===t.path?"text-sm font-medium text-[#1e7be7] cursor-pointer  border-b-3 border-[#1e7be7] py-4.5":"text-sm font-medium text-black cursor-pointer py-4"}
                `,children:t.name})},t.id))}),(0,a.jsxs)("div",{className:"flex items-center space-x-6 mr-4 ",children:[(0,a.jsx)("p",{className:"font-light text-sm ",children:"Notifications"})," ",(0,a.jsx)("img",{className:"size-8 rounded-full",src:"https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",alt:""})]})]})})}},5811:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});let a=(0,s(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/mohsinidrees/Desktop/patient-app/static/src/components/Header.jsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/mohsinidrees/Desktop/patient-app/static/src/components/Header.jsx","default")},6173:(e,t,s)=>{"use strict";s.d(t,{MainProvider:()=>r});var a=s(2907);let r=(0,a.registerClientReference)(function(){throw Error("Attempted to call MainProvider() from the server but MainProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/mohsinidrees/Desktop/patient-app/static/src/context/Globalcontext.jsx","MainProvider");(0,a.registerClientReference)(function(){throw Error("Attempted to call useMainProvider() from the server but useMainProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/mohsinidrees/Desktop/patient-app/static/src/context/Globalcontext.jsx","useMainProvider")},7166:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});let a=(0,s(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/mohsinidrees/Desktop/patient-app/static/src/components/Sidebar.jsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/mohsinidrees/Desktop/patient-app/static/src/components/Sidebar.jsx","default")},7688:(e,t,s)=>{Promise.resolve().then(s.bind(s,5277)),Promise.resolve().then(s.bind(s,9348)),Promise.resolve().then(s.bind(s,9759))},9348:(e,t,s)=>{"use strict";s.d(t,{default:()=>i});var a=s(687);s(3210);var r=s(3877),n=s(9759);let i=()=>{let{selectedFile:e,proccesingState:t,files:s,handleFileChange:i,handleFileSelect:l,handleDrop:o,handleRemoveFile:c,fileInputRef:d}=(0,n.A)(),m=e=>{if(!e||!e.name)return(0,a.jsx)(r.t69,{className:"text-gray-400 text-lg"});let t=e.type||"",s=e.name.toLowerCase();return"text/csv"===t||s.endsWith(".csv")?(0,a.jsx)(r.QaY,{className:"text-green-400 text-lg"}):t.includes("spreadsheet")||s.endsWith(".xls")||s.endsWith(".xlsx")?(0,a.jsx)(r.Ru,{className:"text-green-500 text-lg"}):(0,a.jsx)(r.t69,{className:"text-gray-400 text-lg"})};return(0,a.jsxs)("div",{className:"bg-[#20263e] max-w-[300px] w-full min-h-screen",children:[(0,a.jsx)("div",{className:"py-3 px-6 border-b border-[#2d345d]",children:(0,a.jsx)("img",{src:"/jupyterlab/default/proxy/8000/logo.png",alt:"Logo"})}),(0,a.jsxs)("div",{className:"py-6 px-6",children:[(0,a.jsx)("h1",{className:"font-[500] text-lg text-white",children:"UPLOAD DATA"}),(0,a.jsx)("p",{className:"text-xs py-1 text-[#a6a6a6]",children:"Upload documents you want to summarize"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:`flex flex-col gap-3 justify-center items-center border border-[#3faaeb]/60 rounded-lg mt-4 border-dashed px-4 py-12 ${t?"cursor-not-allowed":" cursor-pointer"} `,onClick:()=>document.getElementById("fileInput").click(),onDragOver:e=>e.preventDefault(),onDrop:o,children:[(0,a.jsx)("input",{type:"file",id:"fileInput",className:"hidden",ref:d,disabled:t,multiple:!0,accept:".csv, .xls, .xlsx",onChange:i}),(0,a.jsx)("svg",{fill:"#505b7e",height:"40px",width:"40px",viewBox:"0 0 374.116 374.116",xmlns:"http://www.w3.org/2000/svg",className:"mb-6",children:(0,a.jsxs)("g",{children:[(0,a.jsx)("path",{d:"M344.058,207.506c-16.568,0-30,13.432-30,30v76.609h-254v-76.609c0-16.568-13.432-30-30-30s-30,13.432-30,30v106.609c0,16.568,13.432,30,30,30h314c16.568,0,30-13.432,30-30V237.506C374.058,220.938,360.626,207.506,344.058,207.506z"}),(0,a.jsx)("path",{d:"M123.57,135.915l33.488-33.488v111.775c0,16.568,13.432,30,30,30c16.568,0,30-13.432,30-30V102.426l33.488,33.488 c5.857,5.858,13.535,8.787,21.213,8.787c7.678,0,15.355-2.929,21.213-8.787c11.716-11.716,11.716-30.71,0-42.426L208.271,8.788 c-11.715-11.717-30.711-11.717-42.426,0L81.144,93.489c-11.716,11.716-11.716,30.71,0,42.426 C92.859,147.631,111.855,147.631,123.57,135.915z"})]})}),(0,a.jsxs)("div",{className:"flex flex-col gap-1 items-center justify-center",children:[(0,a.jsx)("p",{className:"text-xs text-white",children:"Drag and drop files here"}),(0,a.jsx)("p",{className:"text-white py-1 text-sm",children:"-OR-"}),(0,a.jsx)("button",{className:`py-2 px-3 rounded-md text-white text-xs font-bold bg-gradient-to-r from-[#046dfd] via-blue-400 to-[#3cace6] ${t?"cursor-not-allowed":" cursor-pointer"} `,onClick:e=>{e.stopPropagation(),document.getElementById("fileInput").click()},children:"Browse Files"})]})]}),s.length>0&&(0,a.jsxs)("div",{className:"mt-6 bg-[#303751] rounded-lg min-h-[200px] overflow-y-auto",children:[(0,a.jsx)("h3",{className:"text-white text-sm font-semibold px-3 py-2",children:"FILES"}),(0,a.jsx)("hr",{className:"border-1 border-[#3faaeb]/30 mb-2"}),(0,a.jsx)("ul",{className:`"text-white text-xs space-y-2 ${t?"cursor-not-allowed":" cursor-pointer"}`,children:s.map((s,n)=>(0,a.jsxs)("li",{className:`flex items-center justify-between py-2 rounded-md px-2 relative  ${e?.name===s.name?"bg-[#2d345d]":""}  ${t?"cursor-not-allowed":" cursor-pointer"}`,onClick:()=>{t||l(s)},children:[(0,a.jsx)("button",{className:`text-red-400  text-lg mr-2 ${t?"cursor-not-allowed":" cursor-pointer"}`,disabled:t,onClick:e=>{e.stopPropagation(),c(s)},children:"\xd7"}),(0,a.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,a.jsxs)("div",{className:`flex items-center${t?"cursor-not-allowed":" cursor-pointer"}`,children:[m(s),(0,a.jsxs)("div",{className:"ml-2",children:[(0,a.jsx)("p",{className:"text-[12px] truncate text-white",children:s.name}),(0,a.jsxs)("p",{className:"text-[11px] text-white",children:[(s.size/1024).toFixed(2)," KB"]})]})]}),(0,a.jsx)("div",{className:"flex items-center",children:e?.name===s.name&&(0,a.jsx)(r.CMH,{className:"text-green-400 text-lg mr-2"})})]})]},n))})]})]})]})]})}},9404:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,6346,23)),Promise.resolve().then(s.t.bind(s,7924,23)),Promise.resolve().then(s.t.bind(s,5656,23)),Promise.resolve().then(s.t.bind(s,99,23)),Promise.resolve().then(s.t.bind(s,8243,23)),Promise.resolve().then(s.t.bind(s,8827,23)),Promise.resolve().then(s.t.bind(s,2763,23)),Promise.resolve().then(s.t.bind(s,7173,23))},9759:(e,t,s)=>{"use strict";s.d(t,{A:()=>d,MainProvider:()=>c});var a=s(687),r=s(3210),n=s(4430),i=s.n(n),l=s(3103);let o=(0,r.createContext)(),c=({children:e})=>{let[t,s]=(0,r.useState)([]),[n,c]=(0,r.useState)(null),[d,m]=(0,r.useState)([]),[p,u]=(0,r.useState)(!1),[f,h]=(0,r.useState)([]),x=(0,r.useRef)(null),[b,g]=(0,r.useState)({}),[v,y]=(0,r.useState)({}),j="/jupyterlab/default/proxy/8000",P=(0,r.useRef)({}),[w,N]=(0,r.useState)(null),[D,C]=(0,r.useState)(!1),k=["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],$=e=>new Promise(t=>{let s=new FileReader;s.onload=({target:s})=>{let a=[];if("text/csv"===e.type)i().parse(s.result,{header:!0,skipEmptyLines:!0,complete:e=>{t(e.data.map(e=>({...e,status:"Pending",summary:"",classification:""})))}});else if("application/vnd.ms-excel"===e.type||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===e.type){let e=l.LF(s.result,{type:"binary"}),a=e.SheetNames[0],r=e.Sheets[a],n=l.Wp.sheet_to_json(r,{header:1}),i=n[0];t(n.slice(1).map(e=>{let t={};return i.forEach((s,a)=>{t[s]=e[a]}),{...t,status:"Pending",summary:"",classification:""}}))}else console.error("Unsupported file type:",e.type),t([])},"text/csv"===e.type?s.readAsText(e):s.readAsBinaryString(e)}),S=async e=>{let a=e.filter(e=>!t.some(t=>t.file.name===e.name&&t.file.size===e.size)||(console.warn(`Skipping duplicate file: ${e.name}`),!1));if(0===a.length){console.warn("No new files to upload (all files are duplicates).");return}let r=await Promise.all(a.map(async e=>{let t=await $(e);return{file:e,status:"Pending",summary:"",classification:"",tableData:t}}));s(e=>[...e,...r]),c(a[0]),m(r[0].tableData)},E=async e=>{console.log(`Starting processing for file: ${e.name}`),P.current[e.name]={isPaused:!1};let a=t.find(t=>t.file.name===e.name);if(!a||"Pending"!==a.status){console.log(`File: ${e.name} is already processed or in progress`),console.log(a.status,"fileData.status");return}u(!0),s(t=>t.map(t=>t.file.name===e.name?{...t,status:"In Progress"}:t)),console.log("i am here");for(let t=0;t<a.tableData.length;t++){if(P.current[e.name]?.isPaused){console.log(`Processing paused for file: ${e.name}`);return}let r=a.tableData[t];if("Pending"!==r.status)continue;M(t,"In Progress");let n=await I(r,t,e);n&&(M(t,"Done"),R(t,n),s(s=>s.map(s=>s.file.name===e.name?{...s,tableData:s.tableData.map((e,s)=>s===t?{...e,status:"Done",summary:n}:e)}:s)))}P.current[e.name]?.isPaused||s(t=>t.map(t=>t.file.name===e.name?{...t,status:"Done"}:t)),u(!1)},I=async(e,t,a,r)=>{try{let s=await fetch(`${j}/stream-summary?patient_id=${e["Patient ID"]}`,{method:"GET",headers:{"Content-Type":"application/json"},signal:r});if(!s.ok)throw Error(`HTTP error! status: ${s.status}`);let a=s.body.getReader(),n=new TextDecoder,i="";for(;;){let{done:e,value:s}=await a.read();if(e)break;let r=n.decode(s,{stream:!0});i+=r,R(t,i)}if(console.log(`Final Summary for patient ${e["Patient ID"]}:`,i),!i.trim()){console.error("Empty summary received, skipping classification."),M(t,"Error: error generating summary");return}let l=await fetch(`${j}/classify?summary=${encodeURIComponent(i)}`,{method:"GET",headers:{"Content-Type":"application/json"},signal:r});if(!l.ok)throw Error(`HTTP error! status: ${l.status}`);let o=l.body.getReader(),c="";for(;;){let{done:e,value:s}=await o.read();if(e)break;let a=n.decode(s,{stream:!0}).trim();console.log("chunk",a),c+=a,A(t,c)}M(t,"Done"),C(!1)}catch(e){"AbortError"===e.name?console.log("Streaming aborted by user"):(console.error("Error processing summary and classification:",e),M(t,"Error!"),R(t,""),A(t,""),s(e=>e.map(e=>e.file.name===a.name?{...e,tableData:e.tableData.map((e,s)=>s===t?{...e,status:"Error!",summary:"",classification:""}:e)}:e)))}},A=(e,t)=>{m(s=>s.map((s,a)=>a===e?{...s,classification:t}:s)),s(s=>s.map(s=>s.file.name===n.name?{...s,tableData:s.tableData.map((s,a)=>a===e?{...s,classification:t}:s)}:s))},R=(e,t)=>{m(s=>s.map((s,a)=>a===e?{...s,summary:t}:s)),s(s=>s.map(s=>s.file.name===n.name?{...s,tableData:s.tableData.map((s,a)=>a===e?{...s,summary:t}:s)}:s))},M=(e,t)=>{m(s=>s.map((s,a)=>a===e?{...s,status:t}:s)),s(s=>s.map(s=>s.file.name===n.name?{...s,tableData:s.tableData.map((s,a)=>a===e?{...s,status:t}:s)}:s))};return(0,r.useEffect)(()=>{w&&(E(w),N(null))},[w]),(0,a.jsx)(o.Provider,{value:{data:t,setData:s,selectedFile:n,setSelectedFile:c,tableData:d,setTableData:m,handleFileUpload:S,startStreaming:E,updateRowSummary:R,updateRowStatus:M,updateSummaryInGlobalState:(e,t,a)=>{s(s=>s.map(s=>s.file.name===e.name?{...s,status:"Pending",tableData:s.tableData.map((e,s)=>s===t?{...e,summary:a,classification:null,status:"Pending"}:e)}:s))},proccesingState:p,setProccesingState:u,files:f,setFiles:h,handleFileChange:e=>{let t=Array.from(e.target.files).filter(e=>k.includes(e.type));t.length>0&&(h(e=>[...e,...t]),S(t))},handleFileSelect:e=>{c(e);let s=t.find(t=>t.file.name===e.name);s&&m(s.tableData)},handleDrop:e=>{e.preventDefault();let t=Array.from(e.dataTransfer.files).filter(e=>k.includes(e.type));t.length>0&&(h(e=>[...e,...t]),s(e=>[...e,...t]))},handleRemoveFile:e=>{if(s(t=>t.filter(t=>t.file.name!==e.name)),h(t=>t.filter(t=>t.name!==e.name)),n?.name===e.name){let s=t.filter(t=>t.file.name!==e.name);s.length>0?(c(s[0].file),m(s[0].tableData)):(c(null),m([]))}x.current&&(x.current.value="")},fileInputRef:x,startStreaming:E,stopProcessing:e=>{P.current[e.name]={isPaused:!0},C(!0),g(t=>({...t,[e.name]:{isPaused:!0}})),u(!1),s(t=>t.map(t=>t.file.name===e.name?{...t,status:"Pending"}:t))},restartProcessing:e=>{console.log(`Restarting processing for file: ${e.name}`),P.current[e.name]={isPaused:!1},s(t=>t.map(t=>t.file.name===e.name?{...t,status:"Pending",tableData:t.tableData.map(e=>({...e,status:"Pending",summary:"",classification:""}))}:t)),m(e=>e.map(e=>({...e,status:"Pending",summary:"",classification:""}))),N(e)},proccesingState:p,fileProcessingState:b,startProcessing:e=>{console.log(`Resuming processing for file: ${e.name}`),console.log(t,"data"),P.current[e.name]={isPaused:!1},g(t=>({...t,[e.name]:{isPaused:!1}}));let s=t.find(t=>t.file.name===e.name);s&&(s.tableData.some(e=>"Pending"===e.status)?E(e):console.log(`No pending rows left to process for file: ${e.name}`))},stoppedProcessing:D},children:e})},d=()=>(0,r.useContext)(o)}};